<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>工作总结及交接 - 欢迎来到Ali的秘密花园</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
  
  <meta name="description" content="现阶段手头上的工作主要有两块，两份工作均告一段落，但日后可能有新的需求或者异常。所以记录一下两块项目的工作内容和具体的思路，方便其他人维护。

下面列一下具体内容:


翼萨项目


生成一系列docx文档

同洲易题项目


docx转json（划重点）
按数据生成xlsx
解析xlsx
根据后台题目数据生成简单试卷，格式为docx
收藏功能本地数据库库同步




翼萨项目

项目地址

http://develop.coolcto.com/lipengcheng/yisa-consulting-services-portal-frontend">
  
  <meta itemprop="name" content="工作总结及交接 - 欢迎来到Ali的秘密花园">
  <meta itemprop="description" content="现阶段手头上的工作主要有两块，两份工作均告一段落，但日后可能有新的需求或者异常。所以记录一下两块项目的工作内容和具体的思路，方便其他人维护。

下面列一下具体内容:


翼萨项目


生成一系列docx文档

同洲易题项目


docx转json（划重点）
按数据生成xlsx
解析xlsx
根据后台题目数据生成简单试卷，格式为docx
收藏功能本地数据库库同步




翼萨项目

项目地址

http://develop.coolcto.com/lipengcheng/yisa-consulting-services-portal-frontend">
  <meta itemprop="image" content="http://ali1213.github.io/img/author.jpg">
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@coderzh" />
  <meta name="twitter:title" content="工作总结及交接 - 欢迎来到Ali的秘密花园" />
  
  <meta name="twitter:description" content="Node.js和Go的使用者">
  
  <link rel="shortcut icon" href="http://ali1213.github.io/img/favicon.ico"/>
  <link rel="apple-touch-icon" href="http://ali1213.github.io/apple-touch-icon.png" />
  <link rel="apple-touch-icon-precomposed" href="http://ali1213.github.io/apple-touch-icon.png" />
  <link rel="stylesheet" href="http://ali1213.github.io/highlight/styles/github.css">
  <script src="http://ali1213.github.io/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <link rel="stylesheet" href="http://ali1213.github.io/font/hack/css/hack.min.css">
  <link rel="stylesheet" href="http://ali1213.github.io/css/style.css">
  <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
</head>

<body>
  <header>
    <div>
  
  <div id="imglogo">
    <a href="http://ali1213.github.io/"><img src="http://ali1213.github.io/img/logo.svg" alt="欢迎来到Ali的秘密花园" title="欢迎来到Ali的秘密花园"/></a>
  </div>
  
  <div id="textlogo">
    <h1 class="site-name"><a href="http://ali1213.github.io/" title="欢迎来到Ali的秘密花园">欢迎来到Ali的秘密花园</a></h1>
    <h2 class="blog-motto">既然来了，就别走了</h2>
  </div>
  <div class="navbar"><a class="navbutton navmobile" href="#" title="menu"></a></div>
  <nav class="animated">
    <ul>
      
      <li><a href="/">首页</a></li>
      
      <li><a href="/about">关于</a></li>
      
      <li>
        <form class="search" method="get" action="https://www.google.com/search">
          <div>
            <input type="text" id="search" name="q" placeholder="搜索">
          </div>
        </form>
      </li>
    </ul>
  </nav>
</div>

  </header>
  <div id="container">
    <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody">
    <header class="article-info clearfix">
  <h1 itemprop="name">
      <a href="http://ali1213.github.io/post/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93%E5%8F%8A%E4%BA%A4%E6%8E%A5/" title="工作总结及交接" itemprop="url">工作总结及交接</a>
  </h1>
  <span id="busuanzi_container_page_pv">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;本文总阅读量<span id="busuanzi_value_page_pv"></span>次
  </span>
  <p class="article-author">By
    
      <a href="http://ali1213.github.io/post/" title="ali">ali</a>
    
  </p>
  <p class="article-time">
    <time datetime="2017-05-27 23:38:39 &#43;0800 CST" itemprop="datePublished">2017年05月27日</time>
  </p>
</header>

	<div class="article-content">
    
		<div class="toc-article">
			<strong class="toc-title">文章目录</strong>
      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#翼萨项目">翼萨项目</a>
<ul>
<li><a href="#项目地址">项目地址</a></li>
<li><a href="#工作内容">工作内容</a></li>
<li><a href="#流程图">流程图</a></li>
<li><a href="#项目设计">项目设计</a>
<ul>
<li><a href="#优点">优点</a></li>
<li><a href="#缺点">缺点</a></li>
</ul></li>
<li><a href="#主要文件及位置">主要文件及位置</a></li>
<li><a href="#使用的插件">使用的插件</a></li>
</ul></li>
<li><a href="#易题项目">易题项目</a>
<ul>
<li><a href="#项目地址-1">项目地址</a></li>
<li><a href="#工作内容-1">工作内容</a></li>
</ul></li>
<li><a href="#docx转json">docx转json</a>
<ul>
<li><a href="#流程图-1">流程图</a></li>
<li><a href="#项目设计-1">项目设计</a>
<ul>
<li><a href="#主要可能维护的地方">主要可能维护的地方</a></li>
</ul></li>
<li><a href="#主要文件及位置-1">主要文件及位置</a></li>
<li><a href="#docx内xml文档标记的一些参考资料">docx内xml文档标记的一些参考资料</a></li>
<li><a href="#使用的插件-1">使用的插件</a></li>
</ul></li>
<li><a href="#按数据生成xlsx">按数据生成xlsx</a></li>
<li><a href="#解析xlsx">解析xlsx</a></li>
<li><a href="#根据后台题目数据生成简单试卷-格式为docx">根据后台题目数据生成简单试卷，格式为docx</a>
<ul>
<li><a href="#项目设计-2">项目设计</a></li>
<li><a href="#主要文件及位置-2">主要文件及位置</a></li>
<li><a href="#使用的插件-2">使用的插件</a></li>
</ul></li>
<li><a href="#收藏功能本地数据库库同步">收藏功能本地数据库库同步</a>
<ul>
<li><a href="#项目设计-3">项目设计</a></li>
<li><a href="#主要文件及位置-3">主要文件及位置</a></li>
<li><a href="#使用的插件-3">使用的插件</a></li>
</ul></li>
<li><a href="#写在最后">写在最后</a></li>
</ul></li>
</ul>
</nav>
		</div>
    
    <p>现阶段手头上的工作主要有两块，两份工作均告一段落，但日后可能有新的需求或者异常。所以记录一下两块项目的工作内容和具体的思路，方便其他人维护。</p>

<p>下面列一下具体内容:</p>

<ul>
<li>翼萨项目

<ul>
<li>生成一系列docx文档</li>
</ul></li>
<li>同洲易题项目

<ul>
<li>docx转json（划重点）</li>
<li>按数据生成xlsx</li>
<li>解析xlsx</li>
<li>根据后台题目数据生成简单试卷，格式为docx</li>
<li>收藏功能本地数据库库同步
</li>
</ul></li>
</ul>

<h2 id="翼萨项目">翼萨项目</h2>

<h3 id="项目地址">项目地址</h3>

<p><a href="http://develop.coolcto.com/lipengcheng/yisa-consulting-services-portal-frontend">http://develop.coolcto.com/lipengcheng/yisa-consulting-services-portal-frontend</a></p>

<h3 id="工作内容">工作内容</h3>

<p>从两个数据源取出数据，按照参数不同 -&gt;生成多个文件，并打包，然后上传到七牛云存储，然后将url返回给前端</p>

<h3 id="流程图">流程图</h3>

<p><img src="http://upload-images.jianshu.io/upload_images/2453666-57a8d48e7d81af30.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="yisa流程图.png" /></p>

<h3 id="项目设计">项目设计</h3>

<p>因为基本上可以说是从一个数据源，然后生成多个文件的过程。
项目采用的是模板替换的方式，从模板的docx文件，标记文字，然后替换其中的标记。</p>

<p>目前在项目中只能标记图片和文字，不能标记表格，标记如图所示、</p>

<p>标记文字使用<code>{key}</code>：</p>

<p><img src="http://upload-images.jianshu.io/upload_images/2453666-55a054a5ec247b16.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ图片20170525134839.png" /></p>

<h4 id="优点">优点</h4>

<ul>
<li>开发速度快</li>
<li>添加的文字随模板文件的字体样式和格式</li>
</ul>

<h4 id="缺点">缺点</h4>

<ul>
<li>需要通过hack的方式去应对项目方奇葩的需求</li>
</ul>

<p>举个栗子，项目放需要根据不同数目的(董事+监事+经理) 生成不同数目的表格。我用了hack的方式，设置了多个不同模板，然后根据js去判断数量，然后选用不同的模板。</p>

<p><img src="http://upload-images.jianshu.io/upload_images/2453666-c8ce7605c6710f98.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="QQ截图20170525135549.png" /></p>

<p>看着上面整齐划一的模板，我的内心是崩溃了。
产品经理，在项目开始的时候，不是说好了没有这种诡异的需求了么？</p>

<ul>
<li>需要严格控制模板的格式和变量名</li>
</ul>

<p>举二个栗子，
针对表格内填充图片的行为，需要提前设置好表格中单元格的宽高，以免产生与预期不匹配</p>

<p>采用统一的数据处理（下文中的dataMiddleHandle.js文件），模板内相应的地方都需要填入对应的变量名</p>

<ul>
<li>无法替换表格</li>
</ul>

<h3 id="主要文件及位置">主要文件及位置</h3>

<pre><code class="language-javascript">\mewchan\node_modules\docxmodule
//存放docx模板的文件
\mewchan\node_modules\docx.js
//生成模板文件的封装

\mewchan\node_modules\dataMiddleHandle.js
//数据处理中心
\mewchan\kitties\moduledocx
//接口及处理处理除数据外其他逻辑的地方
</code></pre>

<h3 id="使用的插件">使用的插件</h3>

<ul>
<li><p>docxtemplater</p>

<ul>
<li>用途： 根据模板和数据生成docx文件, 只能替换模板内的文字</li>
<li>地址： <a href="https://www.npmjs.com/package/docxtemplater">https://www.npmjs.com/package/docxtemplater</a></li>
</ul></li>

<li><p>docxtemplater-image-module</p>

<ul>
<li>用途：docxtemplater的插件，使之能 替换模板内的图片标记</li>
<li>地址： <a href="https://www.npmjs.com/package/docxtemplater-image-module">https://www.npmjs.com/package/docxtemplater-image-module</a></li>
</ul></li>

<li><p>Downloader</p>

<ul>
<li>用途：other的下载包，用于下载将替换到模板的图片从七牛下载到本地</li>
<li>地址：</li>
</ul></li>

<li><p>Uploader</p>

<ul>
<li>用途：other在七牛官方包上的进一步封装，提供往七牛上传文件的服务。在本项目中，用于将生成的docx和压缩包上传到七牛，然后提供url给前端。</li>
<li>地址：</li>
</ul></li>

<li><p>other_client.js</p>

<ul>
<li>用途：other在http请求上的封装，用于给后端发送jsonrpc</li>
<li>地址：</li>
</ul></li>
</ul>

<h2 id="易题项目">易题项目</h2>

<h3 id="项目地址-1">项目地址</h3>

<p><a href="http://develop.coolcto.com/zhujunwei/e_teach_clean">http://develop.coolcto.com/zhujunwei/e_teach_clean</a></p>

<h3 id="工作内容-1">工作内容</h3>

<ul>
<li>docx转json（划重点）</li>
<li>按数据生成xlsx</li>
<li>解析xlsx</li>
<li>根据后台题目数据生成简单试卷，格式为docx</li>
<li>收藏功能本地数据库库同步</li>
</ul>

<h2 id="docx转json">docx转json</h2>

<p>将带有标记的试题题目的文档转化成json并传到后端。
docx内的格式如下</p>

<pre><code class="language-javascript">第一段文字为该试卷的标题
1.   //这里是题号
#
这里是题目内容
#
*
这里是答案
*
{
这是是对答题卡的设置
}

</code></pre>

<h3 id="流程图-1">流程图</h3>

<p><img src="http://upload-images.jianshu.io/upload_images/2453666-422e7ff9e1687363.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="docx转json.png" /></p>

<h3 id="项目设计-1">项目设计</h3>

<p>本质上，docx就是一个xml文档的zip压缩包。</p>

<p>由于历史遗留原因，目前的总的设计是将docx &mdash;&gt;text &mdash;&gt;json</p>

<p>个人觉得，这是一个坑比较大的项目，主要集中在以下三点:</p>

<h4 id="主要可能维护的地方">主要可能维护的地方</h4>

<ul>
<li><p>docx转text，目前是流式处理，遇到不能解析的格式或者文字，则忽略，但由于目前所查的docx资料有限，不能保证office不坑我们。目前小规模测试暂无异常。目前转换的结果存储在<code>path.join(os.tmpdir(),'translate.txt')</code>，可以靠看这个文件去排错。</p></li>

<li><p>text转json， 大坑。目前由于减小客户在往系统里面撸题目的时候尽量简便，所以判断的逻辑很复杂。目前是按行去读取text，然后用状态和正则去记录和判断题干，小题，小题中的小题。不排除客户会用稀奇古怪的序号去标记小题目，导致正则无法判断。目前转换为json的结果存储在<code>path.join(os.tmpdir(),'result.json')</code></p></li>

<li><p>text转json后给每道题目加上类型。最开始只是前端需要根据这个类型去给每个题目套上不同的样式。这个判断并不可靠，只是应急方案。目前判断依据  是有无()或者____，有无选项或者小问。详细判断逻辑参照<code>\mewchan\node_modules\TextToJson\addType.js</code>.</p></li>
</ul>

<h3 id="主要文件及位置-1">主要文件及位置</h3>

<pre><code class="language-javascript">
\mewchan\brain\servlet.js
//处理上传请求接口，会把请求转给handler.js处理

\mewchan\brain\handler.js
//处理请求逻辑

\mewchan\brain\init.js
//在程序初始化时检测如果是win平台且没有拷贝过，则拷贝 转换图片的应用程序到缓存目录

\mewchan\brain\result.json
//报错信息汇总

\mewchan\brain\config.js
//配置文件

\mewchan\node_modules\docx2Text
//自己写的docx转txt模块

\mewchan\node_modules\TextToJson
//将docx转好的txt，再转为txt。因为需要对题目

\mewchan\node_modules\errorList.js
//报错处理

\mewchan\node_modules\imageConvert.js
//将docx内微软格式的图片，转换为可以在页面上显示的图片类型。依赖于imagemagick程序

\mewchan\node_modules\uploadTemp.js
//将文件上传到七牛
</code></pre>

<h3 id="docx内xml文档标记的一些参考资料">docx内xml文档标记的一些参考资料</h3>

<p><a href="https://msdn.microsoft.com/en-us/library/office/gg278308.aspx">https://msdn.microsoft.com/en-us/library/office/gg278308.aspx</a></p>

<p><a href="https://msdn.microsoft.com/en-us/library/office/gg278323.aspx">https://msdn.microsoft.com/en-us/library/office/gg278323.aspx</a></p>

<p><a href="https://msdn.microsoft.com/en-us/library/office/ee922775(v=office.14).aspx">https://msdn.microsoft.com/en-us/library/office/ee922775(v=office.14).aspx</a></p>

<p>这个网站是我的主要参考源 <a href="http://officeopenxml.com">http://officeopenxml.com</a></p>

<p><a href="http://www.docin.com/p-428010508.html">http://www.docin.com/p-428010508.html</a>
<a href="http://www.taguage.com/tag/55f14c4674ebc826528da22f">http://www.taguage.com/tag/55f14c4674ebc826528da22f</a>
<a href="http://www.bubuko.com/infodetail-1290603.html">http://www.bubuko.com/infodetail-1290603.html</a>
<a href="http://blog.csdn.net/u010371710/article/details/51966236">http://blog.csdn.net/u010371710/article/details/51966236</a></p>

<h3 id="使用的插件-1">使用的插件</h3>

<ul>
<li><p>multer</p>

<ul>
<li>用途： 解析前端通过dropzone插件上传到node端的文件并存到本地</li>
<li>地址： <a href="https://www.npmjs.com/package/multer">https://www.npmjs.com/package/multer</a></li>
</ul></li>

<li><p>Uploader</p>

<ul>
<li>用途：other在七牛官方包上的进一步封装，提供往七牛上传文件的服务。在本项目中，用于将解析的docx中的图片和公式（根据公式生成的docx文档）上传到七牛，然后将返回的url塞进json传给后端。</li>
<li>地址：</li>
</ul></li>

<li><p>@.fs.unzip()</p>

<ul>
<li>用途： 将docx解压，以便读取其中的xml文档</li>
<li>地址: 参照what中<a href="http://what.coolcto.com/#!/activity/main/what-detail-page?documentID=123&amp;hasToc=true&amp;title=mew_util 文档">mewUtil文档</a></li>
</ul></li>

<li><p>imagemagick</p>

<ul>
<li>用途：docx内有一些图片和公式的格式为微软官方支持的wmf和emf等图片，不能在前端网页直接显示，所以需要通过插件将这些图片格式转换好。</li>
<li>文件路径： <code>\mewchan\brain\imageconvert.zip</code></li>
<li>地址： <a href="http://www.imagemagick.org/script/index.php">http://www.imagemagick.org/script/index.php</a></li>
</ul></li>

<li><p>other_client.js</p>

<ul>
<li>用途：other在http请求上的封装，用于给后端发送jsonrpc</li>
<li>地址：</li>
</ul></li>
</ul>

<h2 id="按数据生成xlsx">按数据生成xlsx</h2>

<p>用于 方便客户下载一个excel文档，从题库生成试卷用到的，在excel内选择需要添加的题目类型，考察的知识点啊。由于excel如果任由客户发挥的话，也挺污的。所以自己写了一个拼接xml然后打包生成excel的。提供</p>

<ul>
<li>单元格可填写文字</li>
<li>单元格可使用下拉单选框</li>
<li>指定区域外的单元格不能编辑</li>
</ul>

<p>这三个定制功能.
详细可参考<code>\mewchan\node_modules\excelCreater\README.MD</code></p>

<p>如果后续有更多的要求，建议使用 <a href="https://www.npmjs.com/package/exceljs">exceljs</a>替代</p>

<h2 id="解析xlsx">解析xlsx</h2>

<p>主要使用的是<a href="https://www.npmjs.com/package/node-xlsx">node-xlsx</a>, 因为<code>mew_js</code>系统目前不支持ES7，所以对其中部分代码从ES7-&gt;ES6。然后在外面包了一层，保证取出的数据符合后端需要的格式。具体详见<code>\mewchan\node_modules\xlsx</code>目录</p>

<h2 id="根据后台题目数据生成简单试卷-格式为docx">根据后台题目数据生成简单试卷，格式为docx</h2>

<p>根据前端发过来的订单号，从后台取出数据，然后生成试卷。</p>

<h3 id="项目设计-2">项目设计</h3>

<p>目前的需求是从后台取出数据，然后依次下载图片和公式，给题目的选项和小问加上序号（这个依赖于解析docx加上的题目类型）。然后根据数据生成docx；</p>

<p>理论上讲，因为数据都是从后台拿的，源数据是解析docx得到的，不会有过多的问题。</p>

<h3 id="主要文件及位置-2">主要文件及位置</h3>

<pre><code class="language-javascript">\mewchan\node_modules\createPaperAdapter
//依赖包为docxCreater，根据json生成docx文档
</code></pre>

<h3 id="使用的插件-2">使用的插件</h3>

<ul>
<li>docxcreater

<ul>
<li>用途： 在office-clippy包基础上改的，用于生成docx。</li>
<li>地址：<a href="https://www.npmjs.com/package/docxcreater">https://www.npmjs.com/package/docxcreater</a></li>
</ul></li>
</ul>

<h2 id="收藏功能本地数据库库同步">收藏功能本地数据库库同步</h2>

<h3 id="项目设计-3">项目设计</h3>

<p>用户端界面，有一个收藏题目的功能，方便用户快速的把收藏的题目放到试卷内。由于功能较为简单，且放在后台有点脏，所以放在用户端了。但随之而来的问题就是。用户可能换电脑。所以需要 数据库同步。目前采用的流程详见流程图。</p>

<p>需要注意的两个小细节
+ 前端传给node的数据库更新不及时（服务器依赖于session），前端判定需要库同步是在刷新页面上。所以上传完成的数据库需要通知前端</p>

<ul>
<li>如果用户在短时间内频繁触发下载和上传数据库逻辑，可能会带来问题。所以分别设定了开关</li>
</ul>

<p>### 流程图</p>

<p><img src="http://upload-images.jianshu.io/upload_images/2453666-f9cd299e7893deef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="数据库库同步逻辑.png" /></p>

<h3 id="主要文件及位置-3">主要文件及位置</h3>

<pre><code class="language-javascript">\mewchan\kitties\e_teach\database.sql
//创建数据库的sql语句

\mewchan\node_modules\replaceSQL.js
//替换数据库的代码

\mewchan\kitties\e_teach\index.js
//数据库增删改查 以及 同步数据库逻辑的代码（hack一些可能出现的问题）

</code></pre>

<h3 id="使用的插件-3">使用的插件</h3>

<ul>
<li><p>sql.js, mdbc.js, sqlite.js</p>

<ul>
<li>用途： other的操作数据库三件套</li>
<li>地址：</li>
</ul></li>

<li><p>Uploader</p>

<ul>
<li>用途：other在七牛官方包上的进一步封装，提供往七牛上传文件的服务。在本项目中，上传数据库文件。</li>
<li>地址：</li>
</ul></li>

<li><p>Downloader</p>

<ul>
<li>用途：other的下载包，用于下载数据库</li>
<li>地址：</li>
</ul></li>

<li><p>other_client.js</p>

<ul>
<li>用途：other在http请求上的封装，用于给后端发送jsonrpc</li>
<li>地址：</li>
</ul></li>
</ul>

<h2 id="写在最后">写在最后</h2>

<p>之前提到了exceljs包。附上一段自己的测试代码。</p>

<p>当然，也可以直接去看它的<a href="https://www.npmjs.com/package/exceljs">官方文档</a></p>

<pre><code class="language-javascript">
var Excel = require('exceljs');
var workbook = new Excel.Workbook();
var worksheet =  workbook.addWorksheet('sheet', {
  pageSetup:{paperSize: 9, orientation:'landscape'}
});

//设置行高,符合预期值
worksheet.getRow(1).height = 42.5;

// 可以设置单元格的列宽，实际列宽是9.38，31.38，9.38
worksheet.columns = [
    { header: 'Id', /*key: 'id', */width: 10 },
    { /*header: 'Name',*/ key: 'name', width: 32 },
    { /*header: 'D.O.B.',*/ key: 'DOB', width: 10, outlineLevel: 1 }
];

//合并单元格测试有效
worksheet.mergeCells('A4:B5');
worksheet.getCell('B5').value = 'Hello, World!';

//上下和垂直居中测试有效
worksheet.getCell('B5').alignment = { vertical: 'middle', horizontal: 'center' };

// 测试边框，只对单元格有效
// 边框的粗细为最细
worksheet.getCell('B6:C10').border = {
    top: {style:'thin'},
    left: {style:'thin'},
    bottom: {style:'thin'},
    right: {style:'thin'}
};

// 测试单元格背景颜色
worksheet.getCell('C10').fill = {
    type: 'pattern',
    pattern:'solid',
    // bgColor:{argb:'CCFFFF00'}
    fgColor:{argb:'FFCCFFFF'}
};
worksheet.getCell('C10').value = &quot;测试&quot;;

worksheet.getCell('C11').fill = {
    type: 'pattern',
    pattern:'solid',
    // bgColor:{argb:'EEF7FF00'}
    fgColor:{argb:'FFEEF7FF'}
};
worksheet.getCell('C11').value = &quot;测试&quot;;

// 测试更改字体的一些属性
worksheet.getCell('C12').font = {
    name: 'Comic Sans MS',
    // family: 4,
    // size: 16,
    // underline: true,
    bold: true,
    color: {argb:'FFEEF7FF'}
};
worksheet.getCell('C12').value = &quot;测试2&quot;

//数字格式按照这样处理是可以的;
worksheet.getCell('C13').value = &quot;11.212323&quot;


//测试直接添加二维数组
worksheet.addRows([[111,222,333],[&quot;shenme&quot;,&quot;shenme&quot;]]);

//测试输出文件
workbook.xlsx.writeFile(&quot;./1.xlsx&quot;)
    .then(function() {
       console.log(&quot;done&quot;)
    });

</code></pre>
	</div>
  <footer class="article-footer clearfix">
  

<div class="article-tags">
  <span></span>
  
  <a href="http://ali1213.github.io/tags/%E9%A1%B9%E7%9B%AE">项目</a>
  
</div>





<div class="article-categories">
  <span></span>
  
  <a class="article-category-link" href="http://ali1213.github.io/categories/%E6%80%BB%E7%BB%93">总结</a>
  
</div>



  <div class="article-share" id="share">
    <div data-url="http://ali1213.github.io/post/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93%E5%8F%8A%E4%BA%A4%E6%8E%A5/" data-title="工作总结及交接" data-tsina="1816308191" class="share clearfix">
    </div>
  </div>
</footer>

	</article>
  



</div>

    <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>
<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">
  

<div class="categorieslist">
  <p class="asidetitle">分类</p>
  <ul>
    
    <li><a href="http://ali1213.github.io/categories/shell" title="shell">shell<sup>1</sup></a></li>
    
    <li><a href="http://ali1213.github.io/categories/%e4%bb%a3%e7%a0%81" title="代码">代码<sup>6</sup></a></li>
    
    <li><a href="http://ali1213.github.io/categories/%e5%b7%a5%e5%85%b7" title="工具">工具<sup>4</sup></a></li>
    
    <li><a href="http://ali1213.github.io/categories/%e5%b7%a5%e5%85%b7%e4%bd%bf%e7%94%a8" title="工具使用">工具使用<sup>1</sup></a></li>
    
    <li><a href="http://ali1213.github.io/categories/%e6%80%bb%e7%bb%93" title="总结">总结<sup>1</sup></a></li>
    
    <li><a href="http://ali1213.github.io/categories/%e6%8a%80%e5%b7%a7" title="技巧">技巧<sup>1</sup></a></li>
    
    <li><a href="http://ali1213.github.io/categories/%e8%af%bb%e4%b9%a6%e7%ac%94%e8%ae%b0" title="读书笔记">读书笔记<sup>20</sup></a></li>
    
    <li><a href="http://ali1213.github.io/categories/%e9%9a%8f%e7%ac%94" title="随笔">随笔<sup>1</sup></a></li>
    
  </ul>
</div>



  

<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
      
			<li><a href="http://ali1213.github.io/tags/2017%e5%b9%b4" title="2017年">2017年<sup>1</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/css" title="css">css<sup>1</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/es6" title="es6">es6<sup>13</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/git" title="git">git<sup>1</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/hexo" title="hexo">hexo<sup>2</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/hugo" title="hugo">hugo<sup>1</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/javascript" title="javascript">javascript<sup>16</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/javscript" title="javscript">javscript<sup>8</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/jquery" title="jquery">jquery<sup>1</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/mongo" title="mongo">mongo<sup>1</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/node.js" title="node.js">node.js<sup>1</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/tesseract" title="tesseract">tesseract<sup>1</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/understanding-ecmascipt6" title="understanding-ecmascipt6">understanding-ecmascipt6<sup>9</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/%e4%b9%a6%e7%b1%8d" title="书籍">书籍<sup>1</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/%e4%bd%a0%e4%b8%8d%e7%9f%a5%e9%81%93%e7%9a%84javascript" title="你不知道的javascript">你不知道的javascript<sup>5</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/%e5%8d%9a%e5%ae%a2" title="博客">博客<sup>3</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/%e6%8a%80%e5%b7%a7" title="技巧">技巧<sup>3</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/%e6%ad%a3%e5%88%99" title="正则">正则<sup>3</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/%e9%94%8b%e5%88%a9%e7%9a%84jquery" title="锋利的jquery">锋利的jquery<sup>4</sup></a></li>
      
			<li><a href="http://ali1213.github.io/tags/%e9%a1%b9%e7%9b%ae" title="项目">项目<sup>1</sup></a></li>
      
		</ul>
</div>



  
  <div class="archiveslist">
    <p class="asidetitle">归档</p>
    <ul class="archive-list">
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2018-04">2018年04月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2018-02">2018年02月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2017-10">2017年10月</a><span class="archive-list-count">3</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2017-09">2017年09月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2017-07">2017年07月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2017-06">2017年06月</a><span class="archive-list-count">2</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2017-05">2017年05月</a><span class="archive-list-count">3</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2017-04">2017年04月</a><span class="archive-list-count">4</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2017-03">2017年03月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2017-02">2017年02月</a><span class="archive-list-count">3</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2016-12">2016年12月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2016-11">2016年11月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2016-10">2016年10月</a><span class="archive-list-count">1</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2016-09">2016年09月</a><span class="archive-list-count">2</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2016-05">2016年05月</a><span class="archive-list-count">3</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#2016-04">2016年04月</a><span class="archive-list-count">5</span>
      </li>
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://ali1213.github.io/post/#0001-01">0001年01月</a><span class="archive-list-count">1</span>
      </li>
      
    </ul>

  </div>


  

<div class="tagcloudlist">
  <p class="asidetitle">标签云</p>
  <div class="tagcloudlist clearfix">
    
    <a href="http://ali1213.github.io/tags/2017%e5%b9%b4" style="font-size: 12px;">2017年</a>
    
    <a href="http://ali1213.github.io/tags/css" style="font-size: 12px;">css</a>
    
    <a href="http://ali1213.github.io/tags/es6" style="font-size: 12px;">es6</a>
    
    <a href="http://ali1213.github.io/tags/git" style="font-size: 12px;">git</a>
    
    <a href="http://ali1213.github.io/tags/hexo" style="font-size: 12px;">hexo</a>
    
    <a href="http://ali1213.github.io/tags/hugo" style="font-size: 12px;">hugo</a>
    
    <a href="http://ali1213.github.io/tags/javascript" style="font-size: 12px;">javascript</a>
    
    <a href="http://ali1213.github.io/tags/javscript" style="font-size: 12px;">javscript</a>
    
    <a href="http://ali1213.github.io/tags/jquery" style="font-size: 12px;">jquery</a>
    
    <a href="http://ali1213.github.io/tags/mongo" style="font-size: 12px;">mongo</a>
    
    <a href="http://ali1213.github.io/tags/node.js" style="font-size: 12px;">node.js</a>
    
    <a href="http://ali1213.github.io/tags/tesseract" style="font-size: 12px;">tesseract</a>
    
    <a href="http://ali1213.github.io/tags/understanding-ecmascipt6" style="font-size: 12px;">understanding-ecmascipt6</a>
    
    <a href="http://ali1213.github.io/tags/%e4%b9%a6%e7%b1%8d" style="font-size: 12px;">书籍</a>
    
    <a href="http://ali1213.github.io/tags/%e4%bd%a0%e4%b8%8d%e7%9f%a5%e9%81%93%e7%9a%84javascript" style="font-size: 12px;">你不知道的javascript</a>
    
    <a href="http://ali1213.github.io/tags/%e5%8d%9a%e5%ae%a2" style="font-size: 12px;">博客</a>
    
    <a href="http://ali1213.github.io/tags/%e6%8a%80%e5%b7%a7" style="font-size: 12px;">技巧</a>
    
    <a href="http://ali1213.github.io/tags/%e6%ad%a3%e5%88%99" style="font-size: 12px;">正则</a>
    
    <a href="http://ali1213.github.io/tags/%e9%94%8b%e5%88%a9%e7%9a%84jquery" style="font-size: 12px;">锋利的jquery</a>
    
    <a href="http://ali1213.github.io/tags/%e9%a1%b9%e7%9b%ae" style="font-size: 12px;">项目</a>
    
  </div>
</div>



  

</aside>

<div>
    <span id="busuanzi_container_site_pv">
        总浏览数:<span id="busuanzi_value_site_pv"></span>次
    </span><br />
    <span id="busuanzi_container_site_uv">
      总访客数:<span id="busuanzi_value_site_uv"></span>次
    </span>
  </div>
</div>

  </div>
  <footer><div id="footer" >
  
  <div class="line">
    <span></span>
    <div style='background:no-repeat url("http://ali1213.github.io/img/author.png") left top;-webkit-background-size:6.875em 6.875em;-moz-background-size:6.875em 6.875em;background-size:6.875em 6.875em;' class="author" ></div>
  </div>
  
  
  <section class="info">
    <p>阿力把勤奋的小人捡起来 <br/> Be Alive Keep Coding</p>
  </section>
  
  <div class="social-font clearfix">
    
    <a href="http://weibo.com/coderzh" target="_blank" title="weibo"></a>
    
    
    <a href="https://twitter.com/coderzh" target="_blank" title="twitter"></a>
    
    
    <a href="https://github.com/ali1213" target="_blank" title="github"></a>
    
    
    <a href="https://www.facebook.com/coderzh" target="_blank" title="facebook"></a>
    
    
    <a href="https://www.linkedin.com/coderzh" target="_blank" title="linkedin"></a>
    
  </div>
  <p class="copyright">Powered by <a href="http://gohugo.io" target="_blank" title="hugo">hugo</a> and Theme by <a href="https://github.com/coderzh/hugo-pacman-theme" target="_blank" title="hugo-pacman-theme">hugo-pacman-theme</a> © 2018
    
    <a href="http://ali1213.github.io/" title="欢迎来到Ali的秘密花园">欢迎来到Ali的秘密花园</a>
    
  </p>
</div>
</footer>
  <script src="http://ali1213.github.io/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
done = false;
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  $('form.search').on('submit', function (event) {
    if (false === done) {
      event.preventDefault();
      var orgVal = $(this).find('#search').val();
      $(this).find('#search').val('site:http:\/\/ali1213.github.io\/ ' + orgVal);
      done = true;
      $(this).submit();
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});
</script>


<link rel="stylesheet" href="http://ali1213.github.io/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="http://ali1213.github.io/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
});
</script>




</body>
</html>
